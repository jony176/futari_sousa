<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ãƒ•ã‚¿ãƒªã‚½ã‚¦ã‚µï¼šã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚·ãƒ¼ãƒˆä½œæˆãƒ„ãƒ¼ãƒ«ï¼ˆè©¦ä½œï¼‰</title>
  <style>
    :root { --gap: 12px; --bd:#e6e6e6; --mut:#666; --bg:#fafafa; }
    body { font-family: system-ui, -apple-system, "Hiragino Sans", "Noto Sans JP", sans-serif; margin: 18px; line-height: 1.55; }
    h1 { margin: 0 0 8px; font-size: 20px; }
    .hint { margin: 0 0 14px; color: var(--mut); }
    .wrap { max-width: 1100px; display: grid; gap: 14px; }
    .row { display:flex; gap: 10px; flex-wrap: wrap; align-items: center; }
    .card { border: 1px solid var(--bd); border-radius: 10px; padding: 12px; background: white; }
    .card h2 { margin:0 0 10px; font-size: 16px; }
    .grid2 { display:grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    @media (max-width: 880px){ .grid2{ grid-template-columns:1fr; } }
    label { display:block; font-size: 13px; color:#222; }
    input[type="text"], input[type="number"], select, textarea {
      width: 100%; box-sizing: border-box; padding: 9px 10px; border: 1px solid var(--bd);
      border-radius: 8px; background: white; font-size: 14px;
    }
    textarea { min-height: 86px; resize: vertical; }
    .seg { display:flex; gap: 8px; flex-wrap: wrap; }
    .seg label { display:flex; align-items:center; gap: 6px; padding: 7px 10px; border:1px solid var(--bd); border-radius:999px; cursor:pointer; background: var(--bg); }
    .seg input { margin:0; }
    .muted { color: var(--mut); font-size: 12px; }
    .pill { display:inline-flex; align-items:center; gap: 8px; padding: 6px 10px; border:1px solid var(--bd); border-radius: 999px; background: var(--bg); font-size: 12px; }
    .ok { border-color:#bfe7c5; background:#f1fff3; }
    .ng { border-color:#f3b3b3; background:#fff2f2; }
    .skills { display:grid; grid-template-columns: repeat(4, 1fr); gap: 10px; }
    @media (max-width: 980px){ .skills{ grid-template-columns: 1fr 1fr; } }
    @media (max-width: 520px){ .skills{ grid-template-columns: 1fr; } }
    .cat { border:1px dashed var(--bd); border-radius: 10px; padding: 10px; }
    .cat h3 { margin:0 0 6px; font-size: 14px; display:flex; justify-content:space-between; align-items:center; gap: 8px;}
    .chk { display:flex; gap: 8px; align-items:flex-start; margin: 6px 0; }
    .chk input { margin-top: 3px; }
    .actions { font-size: 13px; }
    .actions .a { margin: 6px 0; padding: 8px 10px; border: 1px solid var(--bd); border-radius: 10px; background: var(--bg); }
    .btns { display:flex; gap: 10px; flex-wrap:wrap; }
    button {
      border: 1px solid var(--bd); background: white; border-radius: 10px;
      padding: 10px 12px; cursor:pointer; font-size: 14px;
    }
    button.primary { background:#111; color:#fff; border-color:#111; }
    button:active { transform: translateY(1px); }
    .hide { display:none !important; }
    pre.out {
      white-space: pre-wrap; word-break: break-word; background:#0b1020; color:#e8eefc;
      padding: 12px; border-radius: 10px; border: 1px solid #1e2a55; font-size: 13px;
      max-height: 420px; overflow:auto;
    }
    details { border:1px solid var(--bd); border-radius: 10px; padding: 10px; background: white; }
    details > summary { cursor:pointer; font-weight:600; }
  </style>
</head>
<body>
  <h1>ãƒ•ã‚¿ãƒªã‚½ã‚¦ã‚µï¼šã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚·ãƒ¼ãƒˆä½œæˆãƒ„ãƒ¼ãƒ«ï¼ˆHTMLè©¦ä½œï¼‰</h1>
  <p class="hint">ã‚­ãƒ£ãƒ©ç¨®åˆ¥åˆ‡ã‚Šæ›¿ãˆï¼ã‚¯ãƒ©ã‚¹é€£å‹•ï¼ˆèƒŒæ™¯ãƒ»æŠ€èƒ½ãƒ«ãƒ¼ãƒ«ãƒ»ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼‰ï¼æŠ€èƒ½æ•°ã‚¬ãƒ¼ãƒ‰ï¼ãƒ©ãƒ³ãƒ€ãƒ ç”Ÿæˆã‚’å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚UIã¯å‹•ä½œç¢ºèªã—ãªãŒã‚‰æ•´ãˆã¾ã—ã‚‡ã†ã€‚</p>

  <div class="wrap">

    <div class="card">
      <h2>0) ã‚­ãƒ£ãƒ©ç¨®åˆ¥</h2>
      <div class="row">
        <div class="seg" id="roleSeg">
          <label><input type="radio" name="role" value="detective" checked> æ¢åµ</label>
          <label><input type="radio" name="role" value="assistant"> åŠ©æ‰‹</label>
        </div>
        <span class="pill" id="rulePill">æŠ€èƒ½ãƒ«ãƒ¼ãƒ«ï¼šâ€”</span>
        <span class="pill" id="guardPill">æŠ€èƒ½é¸æŠï¼šâ€”</span>
      </div>

      <div class="btns" style="margin-top:10px">
        <button class="primary" id="btnRandomAll">ğŸ² ãƒ©ãƒ³ãƒ€ãƒ ç”Ÿæˆï¼ˆä¸»è¦é …ç›®ï¼‰</button>
        <button id="btnResetSkills">â†© æŠ€èƒ½é¸æŠãƒªã‚»ãƒƒãƒˆ</button>
      </div>
      <p class="muted" style="margin-top:8px">
        â€»ã€Œä¸»è¦é …ç›®ã€ï¼åå‰/å½å/èº«é•·/ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³/å¥½ãå«Œã„/ï¼ˆæ¢åµãªã‚‰ç•°å¸¸ãªç™–ï¼‰/ï¼ˆåŠ©æ‰‹ãªã‚‰ã‚²ã‚¹ãƒˆï¼‰/èƒŒæ™¯ ã¾ã§å…¥ã‚Œã¾ã™ã€‚è·æ¥­ãƒ»å¹´é½¢ãªã©ã¯è‡ªç”±å…¥åŠ›ã®ã¾ã¾ã§ã‚‚OKã€‚
      </p>
    </div>

    <div class="grid2">
      <div class="card">
        <h2>1) åŸºæœ¬æƒ…å ±</h2>
        <div class="grid2">
          <div>
            <label>åå‰</label>
            <input id="name" type="text" placeholder="ä¾‹ï¼šæ±é›² æ’ä¸€ / Sherlock Holmes ãªã©" />
          </div>
          <div>
            <label>å½åï¼ˆä»»æ„ï¼‰</label>
            <input id="alias" type="text" placeholder="ä¾‹ï¼šã€ä¾¿åˆ©å±‹ã€ / ã‚¢ãƒ³ãƒã‚¦ãƒ³ / é…’ã®åå‰ ãªã©" />
            <p class="muted">ï¼ˆãƒ©ãƒ³ãƒ€ãƒ ã§ã€Œå½åè¡¨ã€ã£ã½ã„æ–¹å‘æ€§ã‚‚å…¥ã‚Œã‚‰ã‚Œã¾ã™ï¼‰</p>
          </div>
          <div>
            <label>å¹´é½¢ï¼ˆè‡ªç”±ï¼‰</label>
            <input id="age" type="number" min="0" placeholder="ä¾‹ï¼š27" />
          </div>
          <div>
            <label>èº«é•·ï¼ˆè‡ªç”±ï¼è¡¨ã‹ã‚‰ï¼‰</label>
            <select id="height"></select>
          </div>
          <div>
            <label>ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³ï¼ˆç›®ç«‹ã¤ç‰¹å¾´1ã¤ï¼‰</label>
            <select id="fashion"></select>
          </div>
          <div>
            <label>è·æ¥­ï¼ˆå¹´é½¢ã«è¦‹åˆã£ãŸã‚‚ã®ï¼‰</label>
            <select id="job"></select>
          </div>
          <div>
            <label>å¥½ããªã‚‚ã®ï¼ˆ1ã¤ï¼‰</label>
            <select id="like"></select>
          </div>
          <div>
            <label>å«Œã„ãªã‚‚ã®ï¼ˆ1ã¤ï¼‰</label>
            <select id="dislike"></select>
          </div>
        </div>

        <div id="detectiveOnlyBasics" style="margin-top:12px">
          <label>ç•°å¸¸ãªç™–ï¼ˆæ¢åµã®ã¿ï¼‰</label>
          <select id="weirdHabit"></select>
          <p class="muted">ï¼ˆç™–ã®ã‚«ãƒ†ã‚´ãƒªã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã§1ã¤é¸ã³ã¾ã™ï¼‰</p>
        </div>

        <div style="margin-top:12px">
          <label>è‡ªç”±ãƒ¡ãƒ¢ï¼ˆèƒŒæ™¯è¨­å®šãªã©ï¼‰</label>
          <textarea id="memo" placeholder="è‡ªç”±è¨˜è¿°ï¼šå£ç™–/äººé–“é–¢ä¿‚/ãŸã¾ã‚Šå ´/äº‹ä»¶ã«å¯¾ã™ã‚‹å§¿å‹¢ãªã©"></textarea>
        </div>
      </div>

      <div class="card">
        <h2>2) ã‚¯ãƒ©ã‚¹ï¼èƒŒæ™¯ï¼ˆã‚¯ãƒ©ã‚¹é€£å‹•ï¼‰</h2>

        <div id="detectiveClassBox">
          <label>æ¢åµã®ã‚¯ãƒ©ã‚¹</label>
          <div class="seg" id="detectiveClassSeg" style="margin-top:6px">
            <label><input type="radio" name="dclass" value="blood" checked> é‹å‘½ã®è¡€çµ±</label>
            <label><input type="radio" name="dclass" value="talent"> å¤©æ€§ã®æ‰èƒ½</label>
            <label><input type="radio" name="dclass" value="mania"> ãƒãƒ‹ã‚¢</label>
          </div>
        </div>

        <div id="assistantClassBox" class="hide">
          <label>åŠ©æ‰‹ã®ã‚¯ãƒ©ã‚¹</label>
          <div class="seg" id="assistantClassSeg" style="margin-top:6px">
            <label><input type="radio" name="aclass" value="justice" checked> æ­£ç¾©ã®äºº</label>
            <label><input type="radio" name="aclass" value="passion"> æƒ…ç†±ã®äºº</label>
            <label><input type="radio" name="aclass" value="involved"> å·»ãè¾¼ã¾ã‚Œã®äºº</label>
          </div>
        </div>

        <div style="margin-top:12px">
          <label>èƒŒæ™¯ï¼ˆã‚¯ãƒ©ã‚¹é€£å‹•ã®å€™è£œï¼‰</label>
          <select id="background"></select>
          <p class="muted">ï¼ˆè‡ªä½œã‚‚OKã€‚ãƒ©ãƒ³ãƒ€ãƒ ç”Ÿæˆæ™‚ã¯ã“ã“ã‚‚å…¥ã‚Šã¾ã™ï¼‰</p>
        </div>

        <div style="margin-top:12px">
          <h3 style="margin:0 0 6px; font-size:14px;">ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆè‡ªå‹•ä»˜ä¸ï¼‰</h3>
          <div class="actions" id="actionsBox"></div>
          <p class="muted">ã‚³ã‚¹ãƒˆã¯åŠ©æ‰‹ã®ã€ä½™è£•ã€‘æ¶ˆè²»ã€‚æ¢åµã¯ã€Œãƒ•ã‚¿ãƒªã‚½ã‚¦ã‚µã€ã€åŠ©æ‰‹ã¯ã€Œé£Ÿã‚‰ã„ã¤ãã€ã‚’å¿…ãšç²å¾—ã€‚</p>
        </div>

        <div id="assistantMental" class="hide" style="margin-top:12px">
          <h3 style="margin:0 0 6px; font-size:14px;">ãƒ¡ãƒ³ã‚¿ãƒ«ï¼ˆåŠ©æ‰‹ã®ã¿ï¼‰</h3>
          <div class="row">
            <span class="pill">ä½™è£•ï¼š<b id="yoyu">0</b></span>
            <span class="pill">å¿ƒåŠ´ï¼š<b id="shinro">0</b>ï¼ˆ3ã§ãƒ­ã‚¹ãƒˆï¼‰</span>
          </div>
          <p class="muted">åˆæœŸã¯ ä½™è£•0 / å¿ƒåŠ´0ï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³ä¸­ã«å¤‰å‹•ï¼‰</p>
        </div>

        <details id="guestBox" class="hide" style="margin-top:12px">
          <summary>ã‚²ã‚¹ãƒˆï¼ˆåŠ©æ‰‹ã®ã¿ï¼šä½œæˆæ®µéšã§1äººï¼‰</summary>
          <div class="grid2" style="margin-top:10px">
            <div>
              <label>ã‚²ã‚¹ãƒˆå</label>
              <input id="guestName" type="text" placeholder="ä¾‹ï¼šå°å³¶ ç²å¥ˆ / Rachel" />
            </div>
            <div>
              <label>ã‚²ã‚¹ãƒˆæŠ€èƒ½ï¼ˆ1ã¤ï¼‰</label>
              <select id="guestSkill"></select>
            </div>
            <div style="grid-column:1/-1">
              <label>é–¢ä¿‚</label>
              <select id="guestRelation"></select>
            </div>
          </div>
          <p class="muted">â€»ã‚²ã‚¹ãƒˆã®æŠ€èƒ½ã¯ã€ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®æŠ€èƒ½å€™è£œã‹ã‚‰ã‚‚é¸ã¹ã‚‹æƒ³å®šã§ã€Œå…¨æŠ€èƒ½ãƒªã‚¹ãƒˆã€ã‹ã‚‰1ã¤é¸æŠã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚</p>
        </details>

        <details style="margin-top:12px">
          <summary>ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼æ¬„ï¼ˆä½œæˆæ™‚ã¯ç©ºã§ã‚‚OKï¼‰</summary>
          <div class="grid2" style="margin-top:10px">
            <div><label>ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã®åå‰</label><input id="partnerName" type="text" placeholder="ï¼ˆç©ºæ¬„ã§ã‚‚OKï¼‰"></div>
            <div><label>å‘¼ã³å</label><input id="partnerCall" type="text" placeholder="ä¾‹ï¼šç›¸æ£’ / å…ˆç”Ÿ / å› ãªã©"></div>
            <div><label>æ°—ã«å…¥ã£ãŸã¨ã“ã‚</label><input id="partnerLike" type="text" placeholder="ï¼ˆç©ºæ¬„ã§ã‚‚OKï¼‰"></div>
            <div><label>æ°—ã«å…¥ã‚‰ãªã„ã¨ã“ã‚</label><input id="partnerDislike" type="text" placeholder="ï¼ˆç©ºæ¬„ã§ã‚‚OKï¼‰"></div>
          </div>
        </details>

      </div>
    </div>

    <div class="card">
      <h2>3) æŠ€èƒ½ï¼ˆæ•°ã‚¬ãƒ¼ãƒ‰ä»˜ãï¼‰</h2>
      <p class="muted" id="skillsHelp">â€”</p>

      <div class="skills" id="skillsGrid"></div>

      <div class="row" style="margin-top:10px">
        <span class="pill" id="reqPill">è¦ä»¶ï¼šâ€”</span>
        <span class="pill" id="freePill">è‡ªç”±æ ï¼šâ€”</span>
        <span class="pill" id="totalPill">åˆè¨ˆï¼šâ€”</span>
      </div>

      <p class="muted" style="margin-top:8px">
        ã‚¬ãƒ¼ãƒ‰ä»•æ§˜ï¼šã‚«ãƒ†ã‚´ãƒªä¸Šé™ã¨åˆè¨ˆä¸Šé™ã‚’è¶…ãˆã‚‹ãƒã‚§ãƒƒã‚¯ã¯ãƒ–ãƒ­ãƒƒã‚¯ã—ã¾ã™ã€‚è¦ä»¶æœªé”ã‚«ãƒ†ã‚´ãƒªã¯èµ¤è¡¨ç¤ºã«ãªã‚Šã¾ã™ï¼ˆåˆè¨ˆãŒè¶³ã‚Šãªã„/åã£ã¦ã„ã‚‹ç­‰ã‚‚è¦‹ãˆã‚‹ã‚ˆã†ã«ï¼‰ã€‚
      </p>
    </div>

    <div class="card">
      <h2>4) å‡ºåŠ›ï¼ˆã‚³ãƒ”ãƒšç”¨ï¼‰</h2>
      <div class="btns">
        <button class="primary" id="btnExport">ğŸ“¤ ãƒ†ã‚­ã‚¹ãƒˆå‡ºåŠ›</button>
      </div>
      <pre class="out" id="output">ï¼ˆã“ã“ã«å‡ºåŠ›ã•ã‚Œã¾ã™ï¼‰</pre>
    </div>

  </div>

<script>
/** ========= ãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ¡ãƒ¢ã«åŸºã¥ãï¼‰ ========= **/

// åå‰è¡¨
const lastNames = [
  "ä½è—¤","å‰ç”°","å°å³¶","æŸ´ç”°","ç§‹å±±","æ¸¡è¾º","éˆ´æœ¨","æœ¨æ‘","ä½ã€…æœ¨","å±±å´","æ£®","ç”°ä¸­","é•·è°·å·","å¤ªç”°","è¥¿æ‘","ä¼Šè—¤","ä¸Šç”°","è—¤åŸ","å°æ—","å¤§è¥¿","é«˜æ©‹","çš‡","å®‰è—¤","æ‘ä¸Š","çŸ³ç”°","é–¢","è’äº•","å°é³¥éŠ","ä¸­å·","æ˜Ÿé‡","æ¦æœ¬","é£¯ç”°","å››å­£","æ‰æœ¬","é¦¬å ´","åºƒç€¬","é‚£é ˆ","å²©ç”°","æ—©å·","æ±é›²","æ°´é‡","ä¸–ç•Œ","æš","å¤©é‡","å €","å®‡ç”°å·","è¥¿å±±","è§’ç”°","é¡","éŒç”°","å°å€‰","å²¡","å‚ç”°","é³³","å¤§å·","æ­¦äº•","å°ç¬ åŸ","èŠ¥","è©é‡","æ‰‹å¡š","æ§","è‡¼äº•","å·½",
  "ã‚·ãƒ¥ãƒ«ãƒ„","ãƒŸãƒ¥ãƒ©ãƒ¼","ã‚·ãƒ¥ãƒŠã‚¤ãƒ€ãƒ¼","ãƒã‚¤ãƒ¤ãƒ¼","ã‚¦ã‚§ãƒ¼ãƒãƒ¼","ãƒ›ãƒ•ãƒãƒ³","ãƒˆãƒ¼ãƒ","ãƒ™ãƒ«ãƒŠãƒ¼ãƒ«","ãƒˆãƒ","ãƒ—ãƒ†ã‚£","ãƒ‡ãƒ¥ãƒ©ãƒ³","ã‚·ãƒ¥","ãƒªãƒ¥ã‚¦","ãƒãƒ§ã‚¦","ã‚·ãƒ¥ã‚¦","ãƒãƒãƒ•","ãƒ¢ãƒ­ã‚¾ãƒ•","ã‚¤ãƒ¯ãƒãƒ•","ã‚­ãƒ ","ã‚¤","ãƒ‘ã‚¯",
  "ãƒ¢ãƒªã‚¢ãƒ¼ãƒ†ã‚£","ãƒ›ãƒ¼ãƒ ã‚º","ãƒ¯ãƒˆã‚¹ãƒ³","ãƒãƒ‰ã‚½ãƒ³","ãƒ¬ã‚¹ãƒˆãƒ¬ãƒ¼ãƒ‰","ã‚´ãƒ«ã‚¸ã‚¢ãƒ¼ãƒ","ãƒ•ã‚¡ãƒ¼ã‚¬ã‚½ãƒ³","ã‚¹ã‚¿ãƒ³","ã‚¸ã‚§ãƒ¼ãƒ³","ãƒ¢ãƒ©ãƒ³","ãƒŸãƒ«ãƒ´ã‚¡ãƒ¼ãƒˆãƒ³","ã‚¢ãƒ‰ãƒ©ãƒ¼","ãƒãƒªã‚½ãƒ³","ã‚¦ã‚£ãƒ³ãƒ‡ã‚£ãƒ³ãƒ‘ãƒ³ã‚¯","ã‚¿ãƒ¼ãƒŠãƒ¼","ãƒã‚¹ã‚«ãƒ´ã‚£ãƒ«","ãƒ›ãƒ¼ãƒ—","ã‚¹ãƒ†ã‚¤ãƒ—ãƒ«ãƒˆãƒ³","ãƒˆãƒ¬ãƒãƒ¼","ãƒ¢ãƒ¼ã‚¹ã‚¿ãƒ³","ãƒã‚¹ã‚°ãƒ¬ãƒ¼ãƒ´"
];
const firstNames = [
  "æ¶¼ä»‹","ã²ã‚ˆã‚Š","ç©º","ç´éŸ³","ç«œ","ã•ãã‚‰","æ™ºä¹Ÿ","ç¾ä¹Ÿ","å¤§å’Œ","ç¾æœˆ","å„ª","æ","å¿«äºº","å½©éŸ³","å¤§ç¿”","ç¾ç¾½","ç‘›å¤ª","çœŸå¤®","æ¥“çœŸ","ç™¾èŠ±","ä»","ç¾å„ª","å¹¹å¤ª","ã¿ãšã","é™½å‘","èœæœˆ","éš¼","å„ªèœ","æ­©å¤¢","å„ªè¡£","ç‘ å‰","ä¹ƒæ„›","æ‚ å¸Œ","ã“ã“ã‚","é™½æ–—","è‰å­","è–ä¹Ÿ","é›ªä¹ƒ","å¤ªé™½","ç²å¥ˆ","é¾ä¹‹ä»‹","ç¾å’²","ç¿”å¤ªæœ—","å’Œå¥","éš¼äºº","é›…","æ¨¹","æ„›å¥ˆ","æ¹Š","ã²ãªãŸ","é™½ç¿”","èŠ±éŸ³","ä¼Šç¹”","å¿ƒæ˜¥","è’¼çœŸ","å‡œ","é¾ç”Ÿ","èŠ±","æ‚ çœŸ","å¿ƒæ„›","å–„","èŠ½è¡£","å²³","è«","æ…¶","è˜­","å³äº¬","é›„å¤§","èŒ","é§¿","åƒå°‹","é™¸","æ¥“","æ¶¼å¤ª","ä¸ƒæµ·","è“®","æœªæ¥","è–«","çœŸç†å­","ç›´äºº","å„ªèŠ±","è²´å¤§","æµ·æ–—","æ¡ƒå­","æ‹“æµ·","ä½³å¥ˆ","äº®","å½©é¦™","å¤§åœ°","é‡Œå¥ˆ","åŒ ","äºœç¾","ç¿¼","èŒœ","å’Œä¹Ÿ","æœªæ¥","ä¸€è¼","å¥ˆã€…","åº¸å¹³","æ—©ç´€","æµ·","æå¥ˆ","äº®å¤ª","åƒå¤","å·¦é–€","ç¶¾ä¹ƒ",
  "ãƒ•ã‚§ãƒªãƒƒã‚¯ã‚¹","ã‚¢ãƒ‹ã‚«","ãƒ«ã‚«","ãƒŸã‚¢","ãƒ«ã‚¤ã‚¹","ã‚½ãƒ•ã‚£ã‚¢","ãƒ«ã‚«ã‚¹","ã‚¢ãƒŠ","ãƒã‚¯ã‚·ãƒŸãƒªã‚¢ãƒ³","ãƒãƒ³ãƒŠ","ãƒ•ã‚£ãƒ³","ãƒ¬ãƒŠ","ãƒ¬ã‚ª","ãƒ­ãƒ©","ã‚¢ãƒ€ãƒ ","ãƒ«ã‚¤ãƒ¼ã‚º","ã‚¬ãƒ–ãƒªã‚¨ãƒ«","ã‚¯ãƒ­ã‚¨","ãƒ¦ãƒ¼ã‚´","ã‚¤ãƒã‚¹","ãƒ†ã‚£ãƒ¡ã‚ª","ãƒ¬ã‚¢","ãƒã‚§ãƒ³ãƒ¦","ã‚«ã‚­ãƒ³","ãƒã‚ªãƒ©ãƒ³","ã‚·ãƒ¼ãƒãƒ³","ãƒã‚ªãƒ¦ãƒ¼","ãƒ¦ãƒãƒ³","ãƒ¦ã‚¼","ã‚¤ã‚¤","ãƒ”ãƒ§ãƒ¼ãƒˆãƒ«","ã‚¨ãƒ´ã‚¡","ãƒ¬ã‚ªãƒ‹ãƒ¼ãƒ‰","ã‚¿ã‚¤ã‚·ãƒ£","ã‚¤ãƒ´ã‚¡ãƒ³","ã‚¨ã‚«ãƒã‚§ãƒªãƒ¼ãƒŠ","ã‚¸ãƒ•ãƒ³","ã‚¸ãƒŸãƒ³","ãƒ‰ãƒ³ãƒ’ãƒ§ãƒ³","ãƒã‚¦ãƒ³","ã‚¸ãƒ§ãƒ³ã‚¦","ã‚¹ãƒŸãƒ³",
  "ã‚¸ã‚§ãƒ¼ãƒ ã‚º","ãƒ«ãƒ¼ã‚·ãƒ¼","ã‚·ãƒ£ãƒ¼ãƒ­ãƒƒã‚¯","ã‚»ã‚·ãƒ«","ã‚¸ãƒ§ãƒ³","ãƒ¬ã‚¤ãƒã‚§ãƒ«","ãƒã‚¤ã‚¯ãƒ­ãƒ•ãƒˆ","ãƒ¢ãƒ¼ãƒ‰","ã‚¹ã‚³ãƒƒãƒˆ","ã‚¨ãƒ‡ã‚£ã‚¹","ã‚¸ãƒ¥ã‚»ãƒƒãƒš","ã‚¨ãƒŸãƒªã‚¢","ãƒ­ãƒãƒ¼ãƒˆ","ãƒ¦ãƒ¼ã‚¸ãƒ‹ã‚¢","ã‚·ãƒ‰ãƒ‹ãƒ¼","ã‚­ãƒ£ãƒªãƒ¼","ã‚¢ãƒ¼ã‚µãƒ¼","ãƒ¡ãƒªãƒ¼","ã‚»ãƒã‚¹ãƒãƒ£ãƒ³","ã‚¹ãƒ¼ã‚¶ãƒ³","ãƒãƒ£ãƒ¼ãƒ«ã‚º","ã‚µãƒ©","ã‚¨ãƒãƒ³ã‚¹","ã‚¢ã‚¤ãƒªãƒ¼ãƒ³","ã‚¸ãƒ§ã‚»ãƒ•","ã‚¢ãƒ‹ãƒ¼","ãƒãƒ¬ãƒ³ã‚¿ã‚¤ãƒ³","ãƒ•ãƒ©ãƒ³ã‚·ã‚¹","ãƒ›ãƒ¼ãƒ«","ãƒãƒªã‚¢","ãƒ˜ãƒ³ãƒªãƒ¼","ãƒ™ãƒªãƒ«","ã‚¸ã‚§ãƒ•ã‚¡ãƒ¼ã‚½ãƒ³","ãƒãƒªãƒ¼","ã‚¸ãƒ£ãƒƒã‚¯","ã‚¨ãƒ•ã‚£","ãƒ“ã‚¯ã‚¿ãƒ¼","ã‚¸ã‚§ãƒ¼ãƒ³","ãƒ“ãƒªãƒ¼","ãƒ¡ã‚¢ãƒªãƒ¼","ãƒ¬ã‚¸ãƒŠãƒ«ãƒ‰","ã‚¸ã‚§ãƒŠãƒ¼ãƒ­"
];

// å½åè¡¨ï¼ˆæ–¹å‘æ€§ï¼‰
const aliasSeeds = [
  "å¥½ããªé…’ã®åå‰","å¥½ããªè‰²ã®åå‰","å¥½ããªå‹•ç‰©ã®åå‰","å¥½ããªæƒ‘æ˜Ÿã®åå‰","å¥½ããªæ˜ ç”»ã®åå‰","å¥½ããªãŠè“å­ã®åå‰",
  "å¥½ããªå°èª¬ã®åå‰","å¥½ããªæ˜Ÿåº§ã®åå‰","å¥½ããªä½œå®¶ã®åå‰","å¥½ããªåˆƒç‰©ã®åå‰","å¥½ããªéŠƒå™¨ã®åå‰",
  "æ¥ã¦ã„ã‚‹ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³ã®åå‰","ä»˜ã‘ã¦ã„ã‚‹ã‚¢ã‚¯ã‚»ã‚µãƒªãƒ¼ã®åå‰","å¥½ããªæ–™ç†ã®åå‰",
  "ãŸã ã®é€šã‚Šã™ãŒã‚Š","ç•ªå·ã§å‘¼ã°ã‚Œã¦ã„ã‚‹","æ¢åµ","åŠ©æ‰‹","ã‚¢ãƒ³ãƒã‚¦ãƒ³","é€šç§°ã€ä¾¿åˆ©å±‹ã€","ä¸æ˜"
];

const heightTable = ["éå¸¸ã«é«˜ã„","é«˜ã‚","å¹³å‡çš„","ä½ã‚","éå¸¸ã«ä½ã„","ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã‚ˆã‚Šå°‘ã—é«˜ã„","ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã‚ˆã‚Šå°‘ã—ä½ã„"];

const fashionTable = [
  "é«˜ç´šå¿—å‘","ã‚¹ãƒ¼ãƒ„","ã‚«ã‚¸ãƒ¥ã‚¢ãƒ«ã‚¦ã‚§ã‚¢","ãƒ•ã‚©ãƒ¼ãƒãƒ«ã‚¦ã‚§ã‚¢","ã‚¹ãƒãƒ¼ãƒ„ã‚¦ã‚§ã‚¢","ãƒªãƒ¼ã‚ºãƒŠãƒ–ãƒ«","ã‚µãƒ³ã‚°ãƒ©ã‚¹","Yã‚·ãƒ£ãƒ„",
  "Tã‚·ãƒ£ãƒ„","ãƒãƒƒã‚¯ãƒ¬ã‚¹","å¸½å­","ãƒŸãƒªã‚¿ãƒªãƒ¼é¢¨","ãƒ”ã‚¢ã‚¹","ã‚¸ãƒ£ãƒ¼ã‚¸","ã‚¨ã‚¯ã‚¹ãƒ†","å’Œé¢¨","æŒ‡è¼ª","ãƒãƒ§ãƒ¼ã‚«ãƒ¼","ã‚µãƒ³ãƒ€ãƒ«",
  "ã‚¸ãƒ£ãƒ³ãƒ‘ãƒ¼","ã‚¤ãƒ³ãƒ‘ãƒã‚¹ã‚³ãƒ¼ãƒˆ","ç™½è¡£","ã‚°ãƒ­ãƒ¼ãƒ–","ãƒ‘ã‚¤ãƒ—","ãƒãƒ§ãƒƒã‚­","å’Œæœ","ã‚«ãƒ©ãƒ•ãƒ«ãªè‰²ä½¿ã„","ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã¨åŒã˜","ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³ã«ã“ã ã‚ã‚ŠãŒãªã„"
];

const likeDislikeTable = [
  "æ­»ä½“","çŠ¬","çŒ«","ã‚µã‚¹ãƒšãƒ³ã‚¹","ç‰©èª","ã‚¢ã‚¤ãƒ‰ãƒ«","çŠ¯ç½ª","ã‚ªã‚«ãƒ«ãƒˆ","å¥åº·","ã‚¸ãƒ£ãƒ³ã‚¯ãƒ•ãƒ¼ãƒ‰","é«˜ç´šãªé£Ÿäº‹","ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³",
  "æ¨©åŠ›","åèª‰","å‹æƒ…","ãŠã‚„ã¤","åœ°å…ƒ","å®¶æ—","è­¦å¯Ÿ","éŸ³æ¥½","éŠƒ","è¬","æ¢åµ","ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼","ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã®å¥½ããªã‚‚ã®","ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã®å«Œã„ãªã‚‚ã®","ç‰¹ã«ãªã—",
  "ãƒã‚§ã‚¹ã‚„å°†æ£‹ãªã©ãƒœãƒ¼ãƒ‰ã‚²ãƒ¼ãƒ ","äººé–“","çŸ¥ã‚‰ãªã„ã“ã¨"
];

const jobTable = [
  "ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã¨åŒã˜","ãƒ•ãƒªãƒ¼ã‚¿ãƒ¼","å­¦ç”Ÿï¼ˆå„ªç§€ï¼‰","å­¦ç”Ÿï¼ˆæ™®é€šï¼‰","å­¦ç”Ÿï¼ˆä¸çœŸé¢ç›®ï¼‰","æ•™å¸«ãƒ»è¬›å¸«","ä¼šç¤¾å“¡","ä¸»å¤«ãƒ»ä¸»å©¦","è‡ªå–¶æ¥­",
  "ãƒ‡ã‚£ãƒ¬ãƒƒã‚¿ãƒ³ãƒˆ","åˆ‘äº‹ï¼ˆæ–°äººï¼‰","åˆ‘äº‹ï¼ˆã‚¨ãƒªãƒ¼ãƒˆï¼‰","å…¬å‹™å“¡","æ¢åµåŠ©æ‰‹","æ¢åµï¼ˆæœ‰åï¼‰","æ¢åµï¼ˆæ™®é€šï¼‰","æ¢åµï¼ˆä¸äººæ°—ï¼‰","ç„¡è·","ç ”ç©¶è€…","ä½œå®¶"
];

// æ¢åµã®ç•°å¸¸ãªç™–ï¼ˆã‚«ãƒ†ã‚´ãƒªã”ã¨â†’ã¾ã¨ã‚ã¦1ã¤é¸ã¶ï¼‰
const weirdHabits = [
  // å£ã‹ã‚‰å‡ºã‚‹ç™–
  "çŒ›çƒˆã«æ„Ÿè¬ã®è¨€è‘‰ã‚’è¿°ã¹ã‚‹","çš®è‚‰ã°ã‹ã‚Šã‚’è¨€ã£ã¦ã—ã¾ã†","ç›¸æ‰‹ã®è¨€è‘‰ã‚’è‚¯å®šã—ã¦ã‹ã‚‰å¦å®šã™ã‚‹","ãƒ‹ãƒ¤ãƒ‹ãƒ¤ç¬‘ã„ãªãŒã‚‰è¬ã‚‹","ç›¸æ‰‹ã®è¨€è‘‰ã‚’èã‹ãšã«è‡ªåˆ†ã ã‘å–‹ã‚‹",
  "ã€Œã“ã†ã¯è€ƒãˆã‚‰ã‚Œãªã„ã§ã—ã‚‡ã†ã‹ã€","ã€Œãã‚Œã¨ã‚‚ã€ä½•ã‹éš ã—ã¦ã„ã‚‹ã“ã¨ã§ã‚‚ï¼Ÿã€","ã€Œå¦™ã§ã™ã­ã€","ã€Œã ã„ãŸã„ã‚ã‹ã‚Šã¾ã—ãŸã€","ã€Œé»™ã£ã¦ã„ã‚ã€",
  // å¼·å¼•ãªæ“ä½œã®ç™–
  "å‹æ‰‹ã«æœæŸ»å¯¾è±¡ã®é„ã‚„å¼•ãå‡ºã—ã‚’ç©ºã‘ã‚‹","è­¦å¯Ÿã®æœæŸ»ã«å‰²ã‚Šè¾¼ã‚€","æœæŸ»ã®ãŸã‚ã«ãƒãƒƒã‚­ãƒ³ã‚°ã‚„ä¸æ³•ä¾µå…¥ã‚’è¡Œã†","è¨±å¯ã•ã‚Œã¦ã„ãªã„ã¨ã“ã‚ã«ç«‹ã¡å…¥ã‚‹","è­¦å¯Ÿã®æœæŸ»ã‚’ç›—ã¿è¦‹ã‚„ç›—ã¿èãã™ã‚‹",
  "è¨¼æ‹ å“ã‚’è¨±å¯ãªãè§£ä½“ã™ã‚‹","æœæŸ»å¯¾è±¡ã‚’é¨™ã—ã¦æƒ…å ±ã‚’èãå‡ºã™","å‹æ‰‹ã«é–¢ä¿‚è€…ã®æŒã¡ç‰©ã‚’è§¦ã‚‹","è¨¼æ‹ å“ã‚’å‹æ‰‹ã«æŒã¡æ­©ã„ã¦ã„ã‚‹","å‹æ‰‹ã«é‘‘è­˜ã‚’å§‹ã‚ã‚‹",
  // ã™ã£ã¨ã¼ã‘ç™–
  "è‡ªåˆ†ã®èº«åˆ†ã‚’å½ã£ã¦é–¢ä¿‚è€…ã«è©±ã‚’èã","æƒ…å ±ã‚’éš ã—ãªãŒã‚‰è©±ã‚’èã","ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã¨æ¼”æŠ€ã‚’ã—ã¦æƒ…å ±ã‚’èãå‡ºãã†ã¨ã™ã‚‹","é€šè¡Œäººã®ãµã‚Šã‚’ã—ã¦é–¢ä¿‚è€…ã®è©±ã‚’ç›—ã¿èãã™ã‚‹",
  "å¶ç„¶ã‚’è£…ã£ã¦è¨¼æ‹ å“ã‚’æ‰‹ã«å…¥ã‚Œã¦ã—ã¾ã†","ã‚ã–ã¨ã‚‰ã—ãã™ã£ã¨ã¼ã‘ã‚‹","é–¢ä¿‚è€…ã‚’æ€’ã‚‰ã›ã‚‹æ¼”æŠ€ã‚’ã—ã¦æƒ…å ±ã‚’å¼•ãå‡ºã™","ã‚„ã‚“ã‚ã‚Šã¨é–¢ä¿‚è€…ã‚’è„…ã™",
  "è½ã¨ã—ç‰©ã‚’ã—ãŸã¨ä¸»å¼µã—ã¦ç¾å ´ã‚„è¨¼æ‹ å“ã‚’æ¼ã‚‹","é–¢ä¿‚è€…ã«èª˜å°å°‹å•ã‚’ä»•æ›ã‘ã‚‹",
  // äº‹ä»¶ã«å¤¢ä¸­ç™–
  "ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã®ä½“ã‚’ä½¿ã£ã¦äº‹ä»¶ã‚’å†ç¾ã—ã‚ˆã†ã¨ã™ã‚‹","è¬ã‚’è§£ãã“ã¨ãŒæ¥½ã—ãã¦ç¬‘ã£ã¦ã—ã¾ã†","å¯é£Ÿã‚’å¿˜ã‚Œã¦æœæŸ»ã‚’ã—ã¦ã„ãŸã®ã§æ€¥ã«å€’ã‚Œã‚‹",
  "è€ƒãˆäº‹ã‚’ã—ã¦ã„ã¦èª°ã®å£°ã‚‚èã“ãˆãªã„","äº‹ä»¶ã®ç›¸é–¢å›³ã‚’æ‰‹è¿‘ãªå£ã‚„åºŠã«æ›¸ãå§‹ã‚ã‚‹","äº‹ä»¶ã«é–¢ä¿‚ã™ã‚‹è¨€è‘‰ã‚’æ¬¡ã€…ã«ç™ºã—ã¦æ­¢ã¾ã‚‰ãªã„",
  "äº‹ä»¶è§£æ±ºä»¥å¤–ã®ã“ã¨ã‚’ã¾ã£ãŸãè€ƒãˆã¦ã„ãªã„","äº‹ä»¶ã®æµã‚Œã‚’ã¶ã¤ã¶ã¤ã¨å–‹ã‚Šå§‹ã‚ã‚‹","äº‹ä»¶ç¾å ´ã«è¸ã¿è¾¼ã‚“ã§èª¿ã¹ç‰©ã‚’ã™ã‚‹","é£Ÿäº‹ä¸­ã§ã‚‚ã‹ã¾ã‚ãšäº‹ä»¶ã®è©±ã‚’ã™ã‚‹",
  // ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã¨ã®ç™–
  "ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã®ä¿¡é ¼ã«ç”˜ãˆã‚‹","ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã‚’ç½®ã„ã¦å…ˆã«è¡Œã£ã¦ã—ã¾ã†","ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã«äº‹ä»¶ã«ã¤ã„ã¦ã©ã†æ€ã£ã¦ã„ã‚‹ã‹è³ªå•ã™ã‚‹","ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã«è‡ªæ…¢ã™ã‚‹","ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã«äº‹ä»¶ã«é–¢ã™ã‚‹ã‚¯ã‚¤ã‚ºã‚’å‡ºé¡Œã™ã‚‹",
  "ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã¨äº›ç´°ãªã“ã¨ã§å–§å˜©ã‚’ã™ã‚‹","ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã«æ•™å¸«ã®ã‚ˆã†ã«ãµã‚‹ã¾ã†","ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ãŒã¤ã„ã¦ãã‚‹å‰æã§å‹æ‰‹ã«å‹•ã","ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã«å¯¾ã—ã¦æ‡‡åˆ‡ä¸å¯§ã«äº‹ä»¶ã‚’èª¬æ˜ã™ã‚‹","ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã®è€³å…ƒã§ã„ããªã‚Šå–‹ã‚Šå§‹ã‚ã‚‹",
  // ä½•ã‹ã—ã¦ã„ã‚‹ç™–
  "å¤§é‡ã®æœ¬ã‚’èª­ã‚“ã§ã„ã‚‹","å¥½ããªéŸ³æ¥½ã‚’å¤§éŸ³é‡ã§æµã—ã¦ã„ã‚‹","ä½•ã‹ã®æ•°å¼ã‚’è§£ã„ã¦ã„ã‚‹","å¤§é‡ã®å¥½ç‰©ã‚’ãšã£ã¨é£Ÿã¹ã¦ã„ã‚‹","ãšã£ã¨ãƒ‘ã‚½ã‚³ãƒ³ã‚„ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ãªã©ã®ç”»é¢ã¨å‘ã‹ã„åˆã£ã¦èª¿ã¹ã¦ã„ã‚‹",
  "å°ã•ãªè¬ã‚’è§£ã„ã¦ã„ã‚‹","ãƒã‚§ã‚¹ã‚„å°†æ£‹ãªã©ã‚’æŒ‡ã—ã¦ã„ã‚‹","å–«èŒ¶åº—ã®å¸­ã«åº§ã£ã¦ä½•ã‹ã‚’å¾…ã£ã¦ã„ã‚‹","ãšã£ã¨çœ ã£ã¦ã„ãŸãŒæ€¥ã«èµ·ãã‚‹","ã—ã°ã‚‰ãä½•ã‚‚ã—ãªã„",
  // å¥‡æƒ³å¤©å¤–ãªç™–
  "ã‚„ã‚ã‚ã¨è¨€ã‚ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ã™ã‚‹","ã—ã°ã‚‰ãå§¿ã‚’æ¶ˆã—ã¦ã„ãŸãŒæˆ»ã£ã¦æ¥ãŸ","äºˆæƒ³ã‚‚ã¤ã‹ãªã„ã¨ã“ã‚ï¼ˆåœ°ä¸­ã‚„ç©ºä¸­ãªã©ï¼‰ã‹ã‚‰ç™»å ´ã™ã‚‹","ä½•ã‹ã‚’æ€ã„ã¤ã„ã¦çªç„¶èµ°ã‚Šå‡ºã™","ãµãŒã„ãªã„è‡ªåˆ†ã‚’è²¬ã‚ã‚‹",
  "çŸ¥ã‚‰ãªã„ã†ã¡ã«äº‹ä»¶ã®è¬ã‚’ä¸€ã¤è§£ã„ã¦ã„ãŸ","äº‹ä»¶ã«ã¤ã„ã¦åˆ†ã‹ã£ãŸæ§˜å­ã ãŒèª°ã«ã‚‚æ•™ãˆãªã„","ç½®ãæ‰‹ç´™ã‚„ãƒ¡ãƒ¼ãƒ«ã§å ±å‘Šã‚’ã™ã‚‹ã‚‚å§¿ãŒè¦‹ãˆãªã„","æ™‚è¨ˆã‚’è¦‹ã¦æ€¥ã«å‹•ãå‡ºã—ãŸ","äº‹ä»¶ã¨ã¯é–¢ä¿‚ãªã•ãã†ãªæ–°èã®è¨˜äº‹ã‚’èª­ã‚“ã§ã„ã‚‹",
  // æ€¥ãªã²ã‚‰ã‚ãã®ç™–
  "é£Ÿäº‹ã‚’ã¨ã£ã¦ã„ãŸã‚‰æ€¥ã«è¬ãŒè§£ã‘ã‚‹","åŠ©æ‰‹ã¨ã®ä½•æ°—ãªã„ä¼šè©±ã‹ã‚‰æ€¥ã«è¬ãŒè§£ã‘ã‚‹","èã“ãˆã¦ããŸä¼šè©±ã‹ã‚‰æ€¥ã«è¬ãŒè§£ã‘ã‚‹","é¢¨å‘‚ã«å…¥ã£ã¦ã„ãŸã‚‰æ€¥ã«è¬ãŒè§£ã‘ã‚‹","å¤¢ã®ä¸­ã§æ€¥ã«è¬ãŒè§£ã‘ã‚‹",
  "é¢¨ãŒå¹ã„ã¦é£›ã‚“ã§ããŸã‚‚ã®ã§è¬ãŒè§£ã‘ã‚‹","æœ¬ã‚’èª­ã‚“ã§ã„ãŸã‚‰äº‹ä»¶ã®ãƒ’ãƒ³ãƒˆãŒè¦‹ã¤ã‹ã‚‹","ç¾å ´ã‚’å†ã³è¨ªã‚Œã¦ã²ã‚‰ã‚ã","è³‡æ–™ã‚’ç¢ºèªã—ã¦ã„ã‚‹æœ€ä¸­ã«ã²ã‚‰ã‚ã","é–¢ä¿‚è€…ã¨ä¼šè©±ã‚’ã—ã¦ã„ã‚‹æœ€ä¸­ã«ã²ã‚‰ã‚ã",
  // å–œæ€’å“€æ¥½ã®ç™–
  "æ€¥ã«æ³£ã","æ€¥ã«æ€’ã‚‹","æ€¥ã«ç¬‘ã„ã ã™","æ€¥ã«ãƒã‚¤ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã«ãªã‚‹","æ€¥ã«å–œã¶","æ€¥ã«å«ã¶","æ€¥ã«ãƒ‹ãƒ¤ãƒ‹ãƒ¤ã—å§‹ã‚ã‚‹","æ€¥ã«ã“ã®äº‹ä»¶ã®æ‚²ã—ã•ã‚’èªã‚‹","æ·¡ã€…ã¨ç‰©äº‹ã‚’é€²ã‚ã‚‹","ãƒ­ãƒœãƒƒãƒˆã®ã‚ˆã†ã«æ±ºã‚ã‚‰ã‚ŒãŸã“ã¨ã ã‘ã‚’ã‚„ã‚‹"
];

// èƒŒæ™¯ï¼ˆã‚¯ãƒ©ã‚¹é€£å‹•ï¼‰
const backgroundsDetective = {
  blood: [
    "åæ¢åµã®å…ˆç¥–ï¼ˆçœŸï¼‰","åæ¢åµã®å…ˆç¥–ï¼ˆæƒ³ï¼‰","è¦ªãŒä¸–ç•Œçš„æ¢åµ","è¡—ã®åæ¢åµ","æ¨ç†ä½œå®¶","è‚²ã¦ã®è¦ª","å •ã¡ãŸåæ¢åµ","å¤§æ‚ªäººã®è¡€","éš ã•ã‚ŒãŸè¡€ç­‹","ã‚¯ãƒ­ãƒ¼ãƒ³"
  ],
  talent: [
    "è¶…ã‚¨ãƒªãƒ¼ãƒˆ","ç¬é–“è¨˜æ†¶èƒ½åŠ›","çŸ¥è­˜ã®æ³‰","ã‚¹ãƒ‘ãƒ«ã‚¿æ•™è‚²","æ—¢ã«åæ¢åµ","æ†§ã‚Œã®èƒŒä¸­","ãƒ©ã‚¤ãƒãƒ«","ã‹ã¤ã¦ã®åæ¢åµ","å­¤ç«‹ã—ãŸåæ¢åµ","äººå·¥åæ¢åµ"
  ],
  mania: [
    "ã‚µã‚¹ãƒšãƒ³ã‚¹ãƒãƒ‹ã‚¢","æ­»ä½“ãƒãƒ‹ã‚¢","ç§‘å­¦ãƒãƒ‹ã‚¢","ã„ã‚ã‚†ã‚‹ã‚ªã‚¿ã‚¯","äººé–“ãƒãƒ‹ã‚¢","æ›¸ç‰©ãƒãƒ‹ã‚¢","ã‚ªã‚«ãƒ«ãƒˆãƒãƒ‹ã‚¢","æ¢åµãƒãƒ‹ã‚¢","æš´èµ°ã™ã‚‹çŸ¥è­˜æ¬²","æ­£ç¾©ã®ãƒãƒ‹ã‚¢"
  ]
};

const backgroundsAssistant = {
  justice: ["ãŠäººã‚ˆã—","è¨±ã›ãªã„","ç´å¾—ã—ãŸã„","åˆ©ç”¨ã—ã¦ã„ã‚‹","é ¼ã‚Œã‚‹å”åŠ›è€…","æ­£ç¾©ã®åŒå¿—"],
  passion: ["èƒ½åŠ›ã«ã»ã‚Œè¾¼ã‚“ã ","äººæŸ„ã«ã»ã‚Œè¾¼ã‚“ã ","ä¸€ç›®æƒšã‚Œ","ã‚¦ãƒãŒåˆã£ãŸ","å¯¾ç«‹","æ”¾ã£ã¦ãŠã‘ãªã„"],
  involved: ["ä¸€æ–¹çš„ã«æ°—ã«å…¥ã‚‰ã‚ŒãŸ","ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³è¦å“¡","éå»ã®ãƒ„ã‚±","å¿…è¦ãªäººæ","è¦ªã—ã„äºº","å¶ç„¶ã®ç©ã¿é‡ã­"]
};

const guestRelations = [
  "æ˜”ã®ãƒãƒ‡ã‚£","å‹äºº","è¦ªå‹","é¡”è¦‹çŸ¥ã‚Š","æˆ¦å‹","è…ã‚Œç¸","éå»ã«ä½•ã‹ã‚ã£ãŸ","ã„ã¨ã“","å‹é”ã®å‹é”","é ã„è¦ªæˆš","è¿‘æ‰€ã®äºº","è¿·æƒ‘ã‚’ã‹ã‘ãŸ","å¸«åŒ ",
  "ãƒãƒƒãƒˆã§çŸ¥ã‚Šåˆã£ãŸ","å¶ç„¶çŸ¥ã‚Šåˆã£ãŸ","å‰ã«ä¸€åº¦ã ã‘ã‚ã£ãŸ","ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã®ã“ã¨ã§ç›¸è«‡ã•ã‚ŒãŸ","ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã«ã¤ã„ã¦è³ªå•ã•ã‚ŒãŸ","å¹¼é¦´æŸ“","ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã‚’è¿½ã£ã¦ã„ã‚‹","ä¸€æ–¹çš„ã«çŸ¥ã‚‰ã‚Œã¦ã„ã‚‹"
];

// æŠ€èƒ½ï¼ˆã‚«ãƒ†ã‚´ãƒªï¼‰
const skillsByCat = {
  insight: [
    { key:"å˜˜", desc:"å˜˜ã«æ•æ„Ÿã€‚å–‹ã‚Šæ–¹/æ±—/ç›®ç·šãªã©ã‹ã‚‰é•å’Œæ„Ÿã‚’æ„Ÿã˜å–ã‚‹ã€‚" },
    { key:"å¤‰åŒ–", desc:"äººç‰©ã‚„é¢¨æ™¯ã®å¤‰åŒ–ã‚’è¦‹é€ƒã•ãªã„ï¼ˆé–“é•ã„æ¢ã—ï¼‰ã€‚" },
    { key:"å¤–è¦‹", desc:"å¤–è¦‹ã‹ã‚‰æƒ…å ±ã‚’å¼•ãå‡ºã™ï¼ˆæ€ªæˆ‘è·¡/é«ªå‹/éš ã—äº‹ãªã©ï¼‰ã€‚" },
    { key:"ç‰©ç†", desc:"ç‰©ç†å­¦ã®è¦‹åœ°ã‹ã‚‰ä¸è‡ªç„¶ã•ã‚’è¦‹æŠœãã€‚" },
    { key:"ç¾å ´", desc:"ç¾å ´ã‹ã‚‰ç›´æ„ŸãŒåƒãã€ã‚ãšã‹ãªè¨¼æ‹ ã‹ã‚‰éµã‚’è¦‹ã¤ã‘ã‚‹ã€‚" },
    { key:"å¤©æ°—", desc:"å¤©æ°—å›³ãªã©ã‹ã‚‰äº‹è±¡ã®ä¸è‡ªç„¶ã•ã‚’è¦‹ã¤ã‘ã‚‹ã€‚" }
  ],
  forensic: [
    { key:"äº¤é€š", desc:"äº¤é€šæƒ…å ±ãƒ»é“è·¯ãƒ»ä¹—ã‚Šç‰©ã®çŸ¥è­˜ã€‚" },
    { key:"æƒ…å ±", desc:"ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼é–¢ä¿‚/ãƒãƒƒãƒˆæ¤œç´¢ã®æƒ…å ±åé›†ã€‚" },
    { key:"æŒ‡ç´‹", desc:"æŒ‡ç´‹é‘‘å®šã‚„æŒ‡ç´‹æƒ…å ±ã®ç²å¾—ã€‚" },
    { key:"ç§‘å­¦", desc:"ç§‘å­¦çš„è¦‹åœ°ã§è¨¼æ‹ ã‚’èª¿ã¹ã‚‹ã€‚" },
    { key:"æ³•åŒ»å­¦", desc:"è§£å‰–ãƒ»äººä½“èª¿æŸ»ãƒ»DNAé‘‘å®šãªã©ã€‚" },
    { key:"ç”Ÿç‰©", desc:"å‹•ç‰©/æ˜†è™«/é­š/ã‚¦ã‚£ãƒ«ã‚¹ç­‰ã®èª¿æŸ»ã€‚" }
  ],
  human: [
    { key:"ç¤¾äº¤", desc:"ç´ æ—©ãä»²è‰¯ããªã‚‹ã€‚è·é›¢ã‚’è©°ã‚ã‚‹ã®ãŒå¾—æ„ã€‚" },
    { key:"å®¶äº‹", desc:"æƒé™¤/æ´—æ¿¯/è‚²å…/é£Ÿäº‹ãªã©å®¶äº‹å…¨èˆ¬ãŒå¾—æ„ã€‚" },
    { key:"å™‚è©±", desc:"äººã‚„çµ„ç¹”ã®å™‚è©±ã‚’æ‹¾ã†ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã€‚" },
    { key:"èª¬å¾—", desc:"æ­¢ã‚ã‚‹/ã•ã›ã‚‹ã€‚å¿ƒã«éŸ¿ãè¨€è‘‰ã‚„ç”¨æ„ã§å‹•ã‹ã™ã€‚" },
    { key:"æµè¡Œ", desc:"ãƒˆãƒ¬ãƒ³ãƒ‰/ä»Šé¢¨ã®å–‹ã‚Š/æœ€æ–°æŠ€è¡“ã«è©³ã—ã„ã€‚" },
    { key:"ãƒ“ã‚¸ãƒã‚¹", desc:"å•†è«‡ãƒ»å–å¼•ãƒ»é‡‘éŠ­äº¤æ¸‰ã«ã‚‚å¼·ã„ã€‚" }
  ],
  body: [
    { key:"æ•ç¸›", desc:"æ•ã¾ãˆã¦å‹•ã‘ãªãã™ã‚‹ã€‚ãƒ­ãƒ¼ãƒ—/æ‰‹éŒ æ‰±ã„ã‚‚ã€‚" },
    { key:"é˜²å¾¡", desc:"å—ã‘èº«/å¦¨å®³å›é¿ã€‚è™«ã®å¤§ç¾¤/æµ·è½ã¡ç­‰ã«ã‚‚ã€‚" },
    { key:"æ ¹æ€§", desc:"é™ç•Œä»¥ä¸Šã®åŠ›ã€‚æ°—åˆãŒå¿…è¦ãªã¨ãã€‚" },
    { key:"ä½“åŠ›", desc:"æ¢ã™/èµ°ã‚‹/èãè¾¼ã¿ãªã©ã¨ã«ã‹ãä½“åŠ›ã€‚" },
    { key:"çªç ´", desc:"æ‰‰ç ´ã‚Š/åŒ…å›²çªç ´/æ•ã¾ã‚‹ç­‰ã‚’è‚‰ä½“ã§è§£æ±ºã€‚" },
    { key:"è¿½è·¡", desc:"é€ƒèµ°çŠ¯è¿½è·¡/è¶³è·¡/ã‚«ãƒ¼ãƒã‚§ã‚¤ã‚¹ã€‚è¿½ã„ã¤ãã¯æ•ç¸›ã€‚" }
  ]
};

const allSkillKeys = Object.values(skillsByCat).flat().map(s => s.key);

// ã‚¯ãƒ©ã‚¹åˆ¥ï¼šæŠ€èƒ½ç¿’å¾—ãƒ«ãƒ¼ãƒ«ï¼ˆé¸æŠæ ã®ã¿ï¼å›ºå®šã¯åˆ¥ï¼‰
const rules = {
  detective: {
    blood:  { label:"æ¢åµï¼šé‹å‘½ã®è¡€çµ±",  fixed: [], picks: { insight:2, forensic:2 }, free:2 },
    talent: { label:"æ¢åµï¼šå¤©æ€§ã®æ‰èƒ½",  fixed: [], picks: { insight:2, forensic:3 }, free:1 },
    mania:  { label:"æ¢åµï¼šãƒãƒ‹ã‚¢",      fixed: [], picks: { insight:2, forensic:2, human:1 }, free:1 }
  },
  assistant: {
    justice: { label:"åŠ©æ‰‹ï¼šæ­£ç¾©ã®äºº", fixed:["èª¬å¾—","çªç ´"], picks:{ human:2 }, free:1 },
    passion: { label:"åŠ©æ‰‹ï¼šæƒ…ç†±ã®äºº", fixed:["ç¤¾äº¤","æ ¹æ€§"], picks:{ human:2 }, free:1 },
    involved:{ label:"åŠ©æ‰‹ï¼šå·»ãè¾¼ã¾ã‚Œã®äºº", fixed:["é˜²å¾¡"], picks:{ human:2, body:2 }, free:0 }
  }
};

// ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
const actionTexts = {
  baseDetective: {
    name:"ãƒ•ã‚¿ãƒªã‚½ã‚¦ã‚µ", type:"è£œåŠ©", cost:"ãªã—",
    text:"æœæŸ»ãƒ•ã‚§ã‚¤ã‚ºã®ã‚·ãƒ¼ãƒ³çµ‚äº†æ™‚ã«ä½¿ç”¨ã€‚è‡ªåˆ†ã¨ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã¯äº’ã„ã¸ã®æ„Ÿæƒ…ã‚’1ã¤ã€Œå¼·ã„æ„Ÿæƒ…ã€ã«ã™ã‚‹ã“ã¨ã§ã€æ¬¡ã®ã‚·ãƒ¼ãƒ³ã‚’ã€Œãƒ•ã‚¿ãƒªã‚½ã‚¦ã‚µã‚·ãƒ¼ãƒ³ã€ã«å¤‰æ›´ã§ãã‚‹ã€‚"
  },
  baseAssistant: {
    name:"é£Ÿã‚‰ã„ã¤ã", type:"è£œåŠ©", cost:"1",
    text:"åˆ¤å®šã®ã‚µã‚¤ã‚³ãƒ­ã‚’æŒ¯ã£ãŸå¾Œã«ä½¿ç”¨ã€‚ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã¸ã®æ„Ÿæƒ…ã‚’1ã¤ã€Œå¼·ã„æ„Ÿæƒ…ã€ã«ã™ã‚‹ã“ã¨ã§ã€ä½¿ç”¨ã—ãŸã‚µã‚¤ã‚³ãƒ­ã‚’æŒ¯ã‚Šç›´ã›ã‚‹ï¼ˆã“ã®ã¨ãåé¢ä½“ã«ã§ãã‚‹ï¼‰ã€‚"
  },
  detective: {
    blood:  { name:"è¡€ã®ç›´æ„Ÿ", type:"è£œåŠ©", cost:"1", text:"åˆ¤å®šå¾Œã«ä½¿ç”¨ã€‚åˆ¤å®šã«ä½¿ç”¨ã—ãŸã‚µã‚¤ã‚³ãƒ­ã®ç›®ã‚’ã™ã¹ã¦4ã«å¤‰æ›´ã§ãã‚‹ã€‚" },
    talent: { name:"å½“ç„¶çŸ¥ã£ã¦ã„ã‚‹", type:"è£œåŠ©", cost:"ãªã—", text:"ã„ã¤ã§ã‚‚ä½¿ç”¨ã€‚å¥½ããªæŠ€èƒ½ã‚’1ã¤ä¿®å¾—ï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³çµ‚äº†æ™‚ã«å¤±ã†ï¼‰ã€‚1ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«ã¤ã2å›ã¾ã§ã€‚" },
    mania:  { name:"è†¨å¤§ãªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹", type:"è£œåŠ©", cost:"2", text:"é‡è¦ã§ãªã„ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç²å¾—æ™‚ã«ä½¿ç”¨ã€‚ã•ã‚‰ã«é‡è¦ã§ãªã„ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’1ã¤ç²å¾—ã€‚1ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«ã¤ã1å›ã¾ã§ã€‚" }
  },
  assistant: {
    justice: { name:"æ°—åˆã‚’å…¥ã‚Œã‚‹", type:"å¸¸é§", cost:"ãªã—", text:"åˆå‹•æœæŸ»ã®åˆ¤å®šã‚’è¡Œã†ã¨ãã€æœ‰åˆ©ã‚’å¾—ã‚‹ã€‚" },
    passion: { name:"è¦‹ç›´ã™", type:"è£œåŠ©", cost:"ãªã—", text:"æœæŸ»ãƒ•ã‚§ã‚¤ã‚ºä¸­ã€æ¢åµãŒåˆ¤å®šã«ä½¿ã£ãŸã‚µã‚¤ã‚³ãƒ­ã«4ä»¥ä¸ŠãŒã‚ã£ãŸå ´åˆã€æ„Ÿæƒ…ã‚’1ã¤ç²å¾—ã€‚1ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«ã¤ã1å›ã¾ã§ã€‚" },
    involved:{ name:"ã“ã†ãªã‚‹ã¨ã‚ã‹ã£ã¦ãŸ", type:"å¸¸é§", cost:"ãªã—", text:"ãŸã¾ã‚Šå ´ãƒ•ã‚§ã‚¤ã‚ºã§ã€”ä½™è£•ã®ç²å¾—ã€•ã‚’è¡Œã†ã¨ãã€ç²å¾—ã§ãã‚‹ä½™è£•ãŒ1ç‚¹ä¸Šæ˜‡ã™ã‚‹ã€‚" }
  }
};

/** ========= ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ ========= **/
const $ = (id) => document.getElementById(id);
const rand = (arr) => arr[Math.floor(Math.random() * arr.length)];
const uniqRand = (arr, n) => {
  const pool = [...arr];
  const out = [];
  while (pool.length && out.length < n) {
    out.push(pool.splice(Math.floor(Math.random() * pool.length), 1)[0]);
  }
  return out;
};
const escape = (s) => String(s ?? "").replace(/[&<>"']/g, (c)=>({ "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;" }[c]));

/** ========= çŠ¶æ…‹ ========= **/
let state = {
  role: "detective",
  dclass: "blood",
  aclass: "justice",
  // skills: Set of keys
  skills: new Set()
};

/** ========= åˆæœŸåŒ– ========= **/
function initSelect(id, list, placeholder = "é¸æŠã—ã¦ãã ã•ã„") {
  const sel = $(id);
  sel.innerHTML = "";
  const op0 = document.createElement("option");
  op0.value = "";
  op0.textContent = placeholder;
  sel.appendChild(op0);
  for (const v of list) {
    const op = document.createElement("option");
    op.value = v;
    op.textContent = v;
    sel.appendChild(op);
  }
}

function init() {
  initSelect("height", heightTable, "èº«é•·ï¼ˆè¡¨ï¼‰ã‚’é¸æŠ");
  initSelect("fashion", fashionTable, "ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³ç‰¹å¾´ã‚’é¸æŠ");
  initSelect("job", jobTable, "è·æ¥­ã‚’é¸æŠ");
  initSelect("like", likeDislikeTable, "å¥½ããªã‚‚ã®ã‚’é¸æŠ");
  initSelect("dislike", likeDislikeTable, "å«Œã„ãªã‚‚ã®ã‚’é¸æŠ");
  initSelect("weirdHabit", weirdHabits, "ç•°å¸¸ãªç™–ã‚’é¸æŠ");

  initSelect("guestRelation", guestRelations, "é–¢ä¿‚ã‚’é¸æŠ");
  initSelect("guestSkill", allSkillKeys, "æŠ€èƒ½ã‚’é¸æŠ");

  renderAll();

  // listeners
  document.querySelectorAll('input[name="role"]').forEach(r => r.addEventListener("change", (e)=>{
    state.role = e.target.value;
    // skills reset when role changes (safer)
    resetSkills();
    renderAll();
  }));

  document.querySelectorAll('input[name="dclass"]').forEach(r => r.addEventListener("change", (e)=>{
    state.dclass = e.target.value;
    resetSkills();
    renderAll();
  }));

  document.querySelectorAll('input[name="aclass"]').forEach(r => r.addEventListener("change", (e)=>{
    state.aclass = e.target.value;
    resetSkills();
    renderAll();
  }));

  $("btnRandomAll").addEventListener("click", ()=>{
    randomAll();
  });

  $("btnResetSkills").addEventListener("click", ()=>{
    resetSkills();
    renderSkills();
    renderPills();
  });

  $("btnExport").addEventListener("click", ()=>{
    exportText();
  });
}

function getCurrentClassKey() {
  return state.role === "detective" ? state.dclass : state.aclass;
}

function getCurrentRule() {
  const key = getCurrentClassKey();
  return rules[state.role][key];
}

/** ========= ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚° ========= **/
function renderAll() {
  // toggle sections
  const isD = state.role === "detective";
  $("detectiveClassBox").classList.toggle("hide", !isD);
  $("assistantClassBox").classList.toggle("hide", isD);
  $("assistantMental").classList.toggle("hide", isD);
  $("guestBox").classList.toggle("hide", isD);
  $("detectiveOnlyBasics").classList.toggle("hide", !isD);

  // sync radio checked
  document.querySelector(`input[name="role"][value="${state.role}"]`).checked = true;
  if (isD) document.querySelector(`input[name="dclass"][value="${state.dclass}"]`).checked = true;
  else document.querySelector(`input[name="aclass"][value="${state.aclass}"]`).checked = true;

  renderBackground();
  renderActions();
  renderSkills();
  renderPills();
}

function renderBackground() {
  const isD = state.role === "detective";
  const key = getCurrentClassKey();
  const list = isD ? backgroundsDetective[key] : backgroundsAssistant[key];
  initSelect("background", list, "èƒŒæ™¯ã‚’é¸æŠï¼ˆã‚¯ãƒ©ã‚¹é€£å‹•ï¼‰");
}

function renderActions() {
  const isD = state.role === "detective";
  const key = getCurrentClassKey();
  const base = isD ? actionTexts.baseDetective : actionTexts.baseAssistant;
  const extra = isD ? actionTexts.detective[key] : actionTexts.assistant[key];

  const box = $("actionsBox");
  box.innerHTML = `
    <div class="a"><b>${escape(base.name)}</b> / ã‚¿ã‚¤ãƒ—ã€${escape(base.type)}ã€‘/ ã‚³ã‚¹ãƒˆã€${escape(base.cost)}ã€‘<br>${escape(base.text)}</div>
    <div class="a"><b>${escape(extra.name)}</b> / ã‚¿ã‚¤ãƒ—ã€${escape(extra.type)}ã€‘/ ã‚³ã‚¹ãƒˆã€${escape(extra.cost)}ã€‘<br>${escape(extra.text)}</div>
  `;
}

function renderSkills() {
  const rule = getCurrentRule();
  const fixed = new Set(rule.fixed || []);
  // ensure fixed always in state.skills
  for (const f of fixed) state.skills.add(f);

  const req = rule.picks || {};
  const free = rule.free || 0;

  // Build help text
  const reqParts = [];
  for (const [cat, n] of Object.entries(req)) reqParts.push(`${catLabel(cat)} ${n}`);
  const help = `
    ç¾åœ¨ã®ãƒ«ãƒ¼ãƒ«ï¼š<b>${escape(rule.label)}</b><br>
    å›ºå®šæŠ€èƒ½ï¼š<b>${(rule.fixed?.length ? rule.fixed.join("ã€") : "ãªã—")}</b> ï¼
    è¦æ±‚ï¼š<b>${reqParts.length ? reqParts.join("ï¼‹") : "ãªã—"}</b> ï¼
    è‡ªç”±æ ï¼š<b>${free}</b><br>
    â€»è‡ªç”±æ ã¯ã€Œã©ã®ã‚«ãƒ†ã‚´ãƒªã§ã‚‚ã€è¿½åŠ ã§é¸ã¹ã¾ã™ï¼ˆãŸã ã—ã‚«ãƒ†ã‚´ãƒªã”ã¨ã®ä¸Šé™ã¨åˆè¨ˆä¸Šé™ã‚’ã‚¬ãƒ¼ãƒ‰ã—ã¾ã™ï¼‰ã€‚
  `;
  $("skillsHelp").innerHTML = help;

  const grid = $("skillsGrid");
  grid.innerHTML = "";

  for (const [cat, list] of Object.entries(skillsByCat)) {
    const catBox = document.createElement("div");
    catBox.className = "cat";
    const need = req[cat] || 0;

    // caps: required + free (free can be in any category, so we allow each category up to need+free)
    const cap = need + free;

    const header = document.createElement("h3");
    header.innerHTML = `
      <span>${escape(catLabel(cat))}</span>
      <span class="muted" id="count_${cat}">0 / ${need}${free ? `ï¼ˆä¸Šé™${cap}ï¼‰` : ""}</span>
    `;
    catBox.appendChild(header);

    for (const sk of list) {
      const row = document.createElement("label");
      row.className = "chk";

      const cb = document.createElement("input");
      cb.type = "checkbox";
      cb.dataset.skill = sk.key;
      cb.dataset.cat = cat;

      const isFixed = fixed.has(sk.key);
      cb.checked = state.skills.has(sk.key);
      cb.disabled = isFixed;

      cb.addEventListener("change", (e)=>{
        onSkillToggle(e.target);
      });

      const txt = document.createElement("div");
      txt.innerHTML = `<b>${escape(sk.key)}</b><div class="muted">${escape(sk.desc)}</div>`;

      row.appendChild(cb);
      row.appendChild(txt);
      catBox.appendChild(row);
    }
    grid.appendChild(catBox);
  }

  updateSkillCounters();
}

function catLabel(cat) {
  return ({ insight:"æ´å¯Ÿ", forensic:"é‘‘è­˜", human:"äººé–“", body:"è‚‰ä½“" }[cat] || cat);
}

function updateSkillCounters() {
  const rule = getCurrentRule();
  const fixed = new Set(rule.fixed || []);
  const req = rule.picks || {};
  const free = rule.free || 0;

  // Count per category excluding fixed? We count selected in category, but fixed are also part of skills and should show as selected.
  // For meeting "picks" requirements, we count total selected in that category excluding fixed that might belong there too.
  // However fixed skills like èª¬å¾— are in human category and should count as already owned but not as part of "äººé–“ã‚«ãƒ†ã‚´ãƒªã‹ã‚‰2ã¤" (rule text implies picks, not including fixed).
  // So: requirement progress counts only "selectable" picks in those categories, excluding fixed skills.
  const selectedByCat = { insight:0, forensic:0, human:0, body:0 };
  const selectedByCatNoFixed = { insight:0, forensic:0, human:0, body:0 };

  // create reverse lookup: skill -> category
  const skillToCat = {};
  for (const [c, list] of Object.entries(skillsByCat)) {
    for (const s of list) skillToCat[s.key] = c;
  }

  for (const sk of state.skills) {
    const c = skillToCat[sk];
    if (!c) continue;
    selectedByCat[c] += 1;
    if (!fixed.has(sk)) selectedByCatNoFixed[c] += 1;
  }

  // total selectable picked (excluding fixed)
  const totalPicked = Object.values(selectedByCatNoFixed).reduce((a,b)=>a+b,0);

  // total max selectable
  const totalNeed = Object.values(req).reduce((a,b)=>a+b,0) + free;

  // Update per cat counter + color
  for (const cat of Object.keys(skillsByCat)) {
    const need = req[cat] || 0;
    const cap = need + free;
    const el = $(`count_${cat}`);
    if (!el) continue;
    const got = selectedByCatNoFixed[cat];

    el.textContent = `${got} / ${need}${free ? `ï¼ˆä¸Šé™${cap}ï¼‰` : ""}`;

    // decorate category box based on meeting minimum requirement (need)
    const catBox = el.closest(".cat");
    if (need === 0) {
      catBox.classList.remove("ng","ok");
      catBox.classList.add(got > 0 ? "ok" : "");
    } else {
      catBox.classList.toggle("ok", got >= need);
      catBox.classList.toggle("ng", got < need);
    }
  }

  // pills
  const reqParts = [];
  for (const [cat, n] of Object.entries(req)) reqParts.push(`${catLabel(cat)}${n}`);
  $("reqPill").textContent = `è¦ä»¶ï¼š${reqParts.length ? reqParts.join("ï¼‹") : "ãªã—"}`;
  $("freePill").textContent = `è‡ªç”±æ ï¼š${free}`;
  $("totalPill").textContent = `åˆè¨ˆï¼ˆå›ºå®šé™¤ãï¼‰ï¼š${totalPicked} / ${totalNeed}`;

  // top pills summary
  const ok = (totalPicked === totalNeed) && Object.entries(req).every(([cat, n]) => (selectedByCatNoFixed[cat] || 0) >= n);
  $("guardPill").classList.toggle("ok", ok);
  $("guardPill").classList.toggle("ng", !ok);
  $("guardPill").textContent = `æŠ€èƒ½é¸æŠï¼š${ok ? "OK" : "æœªå®Œ/åã‚Šã‚ã‚Š"}`;

  // rule pill
  $("rulePill").textContent = `æŠ€èƒ½ãƒ«ãƒ¼ãƒ«ï¼š${rule.label}`;
}

function renderPills() {
  updateSkillCounters();
}

/** ========= æŠ€èƒ½ï¼šã‚¬ãƒ¼ãƒ‰ãƒ­ã‚¸ãƒƒã‚¯ ========= **/
function onSkillToggle(cb) {
  const rule = getCurrentRule();
  const fixed = new Set(rule.fixed || []);
  const req = rule.picks || {};
  const free = rule.free || 0;

  const skill = cb.dataset.skill;
  const cat = cb.dataset.cat;

  // update state tentative
  if (cb.checked) state.skills.add(skill);
  else state.skills.delete(skill);

  // fixed safety
  for (const f of fixed) state.skills.add(f);

  // compute counts (excluding fixed for selectable)
  const skillToCat = {};
  for (const [c, list] of Object.entries(skillsByCat)) {
    for (const s of list) skillToCat[s.key] = c;
  }

  const selectedByCatNoFixed = { insight:0, forensic:0, human:0, body:0 };
  for (const sk of state.skills) {
    const c = skillToCat[sk];
    if (!c) continue;
    if (!fixed.has(sk)) selectedByCatNoFixed[c] += 1;
  }

  const totalPicked = Object.values(selectedByCatNoFixed).reduce((a,b)=>a+b,0);
  const totalMax = Object.values(req).reduce((a,b)=>a+b,0) + free;

  // per-cat cap
  const need = req[cat] || 0;
  const cap = need + free;
  const gotCat = selectedByCatNoFixed[cat];

  // If over caps, revert checkbox
  if (cb.checked && gotCat > cap) {
    cb.checked = false;
    state.skills.delete(skill);
    alert(`ã‚«ãƒ†ã‚´ãƒªã€Œ${catLabel(cat)}ã€ã®ä¸Šé™ï¼ˆ${cap}ï¼‰ã‚’è¶…ãˆã¦ã„ã¾ã™ã€‚`);
  } else if (cb.checked && totalPicked > totalMax) {
    cb.checked = false;
    state.skills.delete(skill);
    alert(`æŠ€èƒ½ã®åˆè¨ˆä¸Šé™ï¼ˆ${totalMax}ï¼‰ã‚’è¶…ãˆã¦ã„ã¾ã™ã€‚`);
  }

  updateSkillCounters();
}

/** ========= ãƒ©ãƒ³ãƒ€ãƒ ç”Ÿæˆ ========= **/
function randomAll() {
  // name
  const ln = rand(lastNames);
  const fn = rand(firstNames);
  $("name").value = `${ln} ${fn}`;

  // alias (direction)
  const seed = rand(aliasSeeds);
  $("alias").value = seed.startsWith("é€šç§°") ? seed : `ï¼ˆ${seed}ï¼‰`;

  // height / fashion / like / dislike / job (optional random)
  $("height").value = rand(heightTable);
  $("fashion").value = rand(fashionTable);
  $("like").value = rand(likeDislikeTable);
  // dislike should differ if possible
  let dis = rand(likeDislikeTable);
  if (dis === $("like").value) dis = rand(likeDislikeTable);
  $("dislike").value = dis;

  $("job").value = rand(jobTable);

  // background depends on class
  const isD = state.role === "detective";
  const key = getCurrentClassKey();
  const bgList = isD ? backgroundsDetective[key] : backgroundsAssistant[key];
  $("background").value = rand(bgList);

  // weird habit (detective)
  if (isD) {
    $("weirdHabit").value = rand(weirdHabits);
  } else {
    // guest
    const gln = rand(lastNames);
    const gfn = rand(firstNames);
    $("guestName").value = `${gln} ${gfn}`;
    $("guestSkill").value = rand(allSkillKeys);
    $("guestRelation").value = rand(guestRelations);
  }

  // random skills selection to satisfy rule (optional: we can auto-pick)
  autoPickSkills();

  renderSkills();
  renderPills();
}

function resetSkills() {
  state.skills = new Set();
  // add fixed will be re-added on renderSkills
}

function autoPickSkills() {
  resetSkills();
  const rule = getCurrentRule();
  const fixed = new Set(rule.fixed || []);
  for (const f of fixed) state.skills.add(f);

  const req = rule.picks || {};
  const free = rule.free || 0;

  // For each required category, pick N skills randomly (excluding fixed and duplicates)
  const chosen = new Set([...fixed]);

  for (const [cat, n] of Object.entries(req)) {
    const pool = skillsByCat[cat].map(s=>s.key).filter(k => !chosen.has(k));
    const picks = uniqRand(pool, n);
    picks.forEach(k => chosen.add(k));
  }

  // free picks from any category
  if (free > 0) {
    const pool = allSkillKeys.filter(k => !chosen.has(k));
    uniqRand(pool, free).forEach(k => chosen.add(k));
  }

  state.skills = chosen;
}

/** ========= å‡ºåŠ› ========= **/
function exportText() {
  const role = state.role === "detective" ? "æ¢åµ" : "åŠ©æ‰‹";
  const classKey = getCurrentClassKey();
  const rule = getCurrentRule();

  const vals = {
    role,
    class: rule.label,
    name: $("name").value.trim(),
    alias: $("alias").value.trim(),
    age: $("age").value.trim(),
    height: $("height").value,
    fashion: $("fashion").value,
    job: $("job").value,
    like: $("like").value,
    dislike: $("dislike").value,
    background: $("background").value,
    weirdHabit: $("weirdHabit").value,
    memo: $("memo").value.trim(),
    partnerName: $("partnerName").value.trim(),
    partnerCall: $("partnerCall").value.trim(),
    partnerLike: $("partnerLike").value.trim(),
    partnerDislike: $("partnerDislike").value.trim(),
    guestName: $("guestName").value.trim(),
    guestSkill: $("guestSkill").value,
    guestRelation: $("guestRelation").value
  };

  // actions (text)
  const base = state.role === "detective" ? actionTexts.baseDetective : actionTexts.baseAssistant;
  const extra = state.role === "detective" ? actionTexts.detective[classKey] : actionTexts.assistant[classKey];

  // skills (sorted by category)
  const skillToCat = {};
  for (const [c, list] of Object.entries(skillsByCat)) {
    for (const s of list) skillToCat[s.key] = c;
  }
  const skillArr = [...state.skills].filter(Boolean);
  skillArr.sort((a,b)=>{
    const ca = skillToCat[a] || "z";
    const cb = skillToCat[b] || "z";
    if (ca !== cb) return ca.localeCompare(cb);
    return a.localeCompare(b, "ja");
  });

  const lines = [];
  lines.push(`ã€ãƒ•ã‚¿ãƒªã‚½ã‚¦ã‚µ ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã€‘`);
  lines.push(`â–  ç¨®åˆ¥ï¼š${vals.role}`);
  lines.push(`â–  ã‚¯ãƒ©ã‚¹ï¼š${vals.class}`);
  lines.push(`â–  åå‰ï¼š${vals.name || "ï¼ˆæœªå…¥åŠ›ï¼‰"}`);
  if (vals.alias) lines.push(`â–  å½åï¼š${vals.alias}`);
  if (vals.age) lines.push(`â–  å¹´é½¢ï¼š${vals.age}`);
  if (vals.height) lines.push(`â–  èº«é•·ï¼š${vals.height}`);
  if (vals.fashion) lines.push(`â–  ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³ï¼š${vals.fashion}`);
  if (vals.job) lines.push(`â–  è·æ¥­ï¼š${vals.job}`);
  if (vals.like) lines.push(`â–  å¥½ãï¼š${vals.like}`);
  if (vals.dislike) lines.push(`â–  å«Œã„ï¼š${vals.dislike}`);
  if (vals.background) lines.push(`â–  èƒŒæ™¯ï¼š${vals.background}`);
  if (state.role === "detective" && vals.weirdHabit) lines.push(`â–  ç•°å¸¸ãªç™–ï¼š${vals.weirdHabit}`);

  lines.push(``);
  lines.push(`â–  æŠ€èƒ½ï¼š`);
  if (!skillArr.length) lines.push(`  ï¼ˆæœªé¸æŠï¼‰`);
  else {
    const byCat = { insight:[], forensic:[], human:[], body:[] };
    for (const sk of skillArr) {
      const c = skillToCat[sk];
      if (byCat[c]) byCat[c].push(sk);
    }
    for (const c of ["insight","forensic","human","body"]) {
      if (byCat[c].length) lines.push(`  ãƒ»${catLabel(c)}ï¼š${byCat[c].join("ã€")}`);
    }
  }

  lines.push(``);
  lines.push(`â–  ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼š`);
  lines.push(`  ãƒ»${base.name}ï¼ˆ${base.type} / ã‚³ã‚¹ãƒˆ${base.cost}ï¼‰ï¼š${base.text}`);
  lines.push(`  ãƒ»${extra.name}ï¼ˆ${extra.type} / ã‚³ã‚¹ãƒˆ${extra.cost}ï¼‰ï¼š${extra.text}`);

  if (state.role === "assistant") {
    lines.push(``);
    lines.push(`â–  ãƒ¡ãƒ³ã‚¿ãƒ«ï¼šä½™è£•0 / å¿ƒåŠ´0ï¼ˆ3ã§ãƒ­ã‚¹ãƒˆï¼‰`);
    lines.push(``);
    lines.push(`â–  ã‚²ã‚¹ãƒˆï¼š`);
    lines.push(`  ãƒ»åå‰ï¼š${vals.guestName || "ï¼ˆæœªå…¥åŠ›ï¼‰"}`);
    lines.push(`  ãƒ»æŠ€èƒ½ï¼š${vals.guestSkill || "ï¼ˆæœªé¸æŠï¼‰"}`);
    lines.push(`  ãƒ»é–¢ä¿‚ï¼š${vals.guestRelation || "ï¼ˆæœªé¸æŠï¼‰"}`);
  }

  lines.push(``);
  lines.push(`â–  ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼æ¬„ï¼ˆä»»æ„ï¼‰ï¼š`);
  lines.push(`  ãƒ»åå‰ï¼š${vals.partnerName || "ï¼ˆç©ºæ¬„ï¼‰"}`);
  lines.push(`  ãƒ»å‘¼ã³åï¼š${vals.partnerCall || "ï¼ˆç©ºæ¬„ï¼‰"}`);
  lines.push(`  ãƒ»æ°—ã«å…¥ã£ãŸã¨ã“ã‚ï¼š${vals.partnerLike || "ï¼ˆç©ºæ¬„ï¼‰"}`);
  lines.push(`  ãƒ»æ°—ã«å…¥ã‚‰ãªã„ã¨ã“ã‚ï¼š${vals.partnerDislike || "ï¼ˆç©ºæ¬„ï¼‰"}`);

  if (vals.memo) {
    lines.push(``);
    lines.push(`â–  ãƒ¡ãƒ¢ï¼š`);
    lines.push(vals.memo);
  }

  $("output").textContent = lines.join("\n");
}

/** ========= èµ·å‹• ========= **/
init();
</script>
</body>
</html>
